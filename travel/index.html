<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>G331阿尔山自驾游</title>
    <script src="https://webapi.amap.com/maps?v=2.0&key=98a9b1aede875554fc1957f1026b327a"></script>
    <style>
        :root {
            --theme-bg: #f8f9fa;
            --theme-card-bg: #ffffff;
            --theme-text-primary: #212529;
            --theme-text-secondary: #6c757d;
            --theme-accent: #007bff;
            --theme-header: linear-gradient(135deg, #667eea, #764ba2);
            --day1-color: #ff6b6b; --day2-color: #fca311; --day3-color: #fdec51; 
            --day4-color: #4caf50; --day5-color: #2196f3; --day6-color: #3f51b5; --day7-color: #9c27b0;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; }
        body { background-color: var(--theme-bg); color: var(--theme-text-primary); line-height: 1.6; }
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        header {
            text-align: center; margin-bottom: 30px; padding: 30px 20px;
            background: var(--theme-header); color: white;
            border-radius: 12px; box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }
        header h1 { font-size: 2.6rem; margin-bottom: 10px; }
        header p { font-size: 1.2rem; opacity: 0.9; }
        .map-section, .day-container {
            background-color: var(--theme-card-bg); padding: 25px; border-radius: 12px;
            margin-bottom: 30px; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.06);
            border: 1px solid #dee2e6;
        }
        .section-title { font-size: 1.6rem; margin-bottom: 20px; color: var(--theme-accent); border-bottom: 1px solid #e9ecef; padding-bottom: 15px; }
        .map-layout-wrapper { display: flex; gap: 25px; }
        .map-sidebar {
            flex: 0 0 240px; display: flex; flex-direction: column; justify-content: center;
            align-items: center; gap: 20px; background-color: #f8f9fa; border-radius: 10px; padding: 20px;
        }
        .map-container-wrapper { flex: 1; position: relative; }
        .map-container { width: 100%; min-height: 550px; border-radius: 10px; overflow: hidden; }
        .map-legend {
            position: absolute; bottom: 10px; left: 10px; background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(4px); padding: 10px; border-radius: 8px; z-index: 1000; 
            box-shadow: 0 2px 8px rgba(0,0,0,0.15); font-size: 12px;
        }
        .legend-title { font-weight: bold; margin-bottom: 8px; font-size: 13px; color: var(--theme-accent); }
        .legend-item { display: flex; align-items: center; margin-bottom: 6px; }
        .legend-color { width: 16px; height: 16px; border-radius: 4px; margin-right: 8px; }
        .action-group { display: flex; flex-direction: column; align-items: center; width: 100%; }
        .action-label { margin-top: 8px; font-size: 0.8rem; color: var(--theme-text-secondary); text-align: center;}
        .map-btn-primary {
            display: flex; align-items: center; justify-content: center; gap: 10px; 
            background: var(--theme-accent); color: white; padding: 12px 20px;
            border-radius: 8px; text-decoration: none; font-weight: bold; font-size: 1rem;
            transition: opacity 0.2s; text-align: center; width: 100%;
        }
        .map-btn-primary:hover { opacity: 0.85; }
        .qr-code-container { margin-top: 15px; padding: 8px; background: white; border-radius: 8px; }
        #qr-code-img { width: 140px; height: 140px; }
        .day-header { background: var(--theme-header); color: white; padding: 18px; font-size: 1.4rem; margin: -25px -25px 20px -25px; border-top-left-radius: 12px; border-top-right-radius: 12px; }
        .day-summary {
            display: flex; flex-wrap: wrap; justify-content: space-between; align-items: center; gap: 15px;
            padding: 15px; background-color: #f8f9fa; border-radius: 8px; margin-bottom: 20px;
        }
        .summary-item { display: flex; align-items: center; gap: 10px; font-size: 0.9rem; }
        .summary-item-icon { font-size: 1.2rem; color: var(--theme-accent); }
        .spot-cards { display: grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); gap: 20px; }
        .spot-card {
            background-color: #f8f9fa; border-radius: 10px; overflow: hidden; border: 1px solid #e9ecef;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .spot-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.12);
        }
        .spot-img { width: 100%; height: 170px; object-fit: cover; background-color: #dee2e6; }
        .spot-info { padding: 15px; }
        .spot-name { font-size: 1.2rem; font-weight: bold; margin-bottom: 8px; color: var(--theme-accent); }
        .spot-meta { font-size: 0.9rem; color: var(--theme-text-secondary); }
        .custom-marker {
            color: white; border-radius: 50%; width: 26px; height: 26px; font-size: 13px;
            font-weight: bold; text-align: center; line-height: 26px; border: 2px solid white;
            box-shadow: 0 2px 5px rgba(0,0,0,0.4);
        }
        footer { text-align: center; padding: 30px 20px; color: #6c757d; font-size: 0.9rem; }
        @media (max-width: 768px) {
            .map-layout-wrapper { flex-direction: column; }
            .map-sidebar {
                flex-direction: row;
                justify-content: space-evenly;
                align-items: center;
                padding: 15px;
            }
            .map-container { min-height: 50vh; }
            .map-btn-primary { font-size: 0.9rem; padding: 10px 15px; }
            #qr-code-img { width: 100px; height: 100px; }
            .action-label { display: none; } /* Hide labels on mobile to save space */
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>G331阿尔山自驾游</h1>
            <p>从齐齐哈尔出发，开启一场森林、草原与边境的寻梦之旅</p>
        </header>

        <section class="map-section">
            <h2 class="section-title">路线总览地图</h2>
            <div class="map-layout-wrapper">
                <div class="map-sidebar">
                    <div class="action-group">
                        <a href="#" class="map-btn-primary" id="smart-map-btn"><span>📍</span> 在App中打开</a>
                    </div>
                    <div class="qr-code-container">
                        <img id="qr-code-img" src="" alt="地图二维码">
                    </div>
                </div>
                <div class="map-container-wrapper">
                    <div class="map-container" id="container"></div>
                    <div class="map-legend" id="map-legend">
                        <h3 class="legend-title">每日路线</h3>
                    </div>
                </div>
            </div>
        </section>

        <section class="itinerary-section" id="itinerary-section">
            <!-- Itinerary content will be generated by JS -->
        </section>

        <footer>
            <p>© 2025 Presentation Agent </p>
        </footer>
    </div>

    <script>
        window.onload = function () {
            const finalItinerary = {
                exclusiveMapUrl: "amapuri://workInAmap/createWithToken?polymericId=mcp_17cb1a9e198245c8bd549c4da0c56863&from=MCP",
                dailyRoutes: [
                    { day: 1, title: '齐齐哈尔 → 柴河', totalDuration: '约 5小时5分钟', color: '#ff6b6b', points: [ { name: '齐齐哈尔站', coord: [123.995988, 47.340409], img: 'https://aos-comment.amap.com/B01C400C81/comment/174643715413_1746437170552_05316738.jpg', duration: '起点' }, { name: '柴河月亮小镇', coord: [121.30699, 47.55696], img: 'http://store.is.autonavi.com/showpic/34710f1030238ce3bc64f3d3442d1ce0', duration: '约 5小时5分钟' } ], hotel: { name: '柴河月亮天池酒店', address: '柴河镇月亮天池景区' } },
                    { day: 2, title: '柴河 → 阿尔山', totalDuration: '约 1小时51分钟', color: '#fca311', points: [ { name: '柴河月亮小镇', coord: [121.30699, 47.55696], img: 'http://store.is.autonavi.com/showpic/34710f1030238ce3bc64f3d3442d1ce0', duration: '起点' }, { name: '阿尔山国家森林公园', coord: [120.421996, 47.284044], img: 'http://store.is.autonavi.com/showpic/e3cdeea5740d0f0ca054e3db2130ac2c', duration: '约 1小时51分钟' } ], hotel: { name: '阿尔山天池度假酒店', address: '国家森林公园内' } },
                    { day: 3, title: '阿尔山 → 满洲里', totalDuration: '约 6小时1分钟', color: '#fdec51', points: [ { name: '阿尔山', coord: [120.421996, 47.284044], img: 'http://store.is.autonavi.com/showpic/e3cdeea5740d0f0ca054e3db2130ac2c', duration: '起点' }, { name: '满洲里市', coord: [117.379134, 49.59862], img: 'https://aos-comment.amap.com/B01D60NCRC/comment/content_media_external_images_media_100001729_1733881666225_75052673.jpg', duration: '约 6小时1分钟' } ], hotel: { name: '满洲里友谊宾馆', address: '一道街26号' } },
                    { day: 4, title: '满洲里 → 室韦', totalDuration: '约 6小时49分钟', color: '#4caf50', points: [ { name: '满洲里', coord: [117.379134, 49.59862], img: 'https://aos-comment.amap.com/B01D60NCRC/comment/content_media_external_images_media_100001729_1733881666225_75052673.jpg', duration: '起点' }, { name: '额尔古纳河乌兰山景区', coord: [119.451961, 50.603812], img: 'http://store.is.autonavi.com/showpic/390aa13837a38455b8f34e6f445a1c2f', duration: '约 4小时56分钟' }, { name: '中国室韦口岸', coord: [119.895746, 51.334108], img: 'https://aos-comment.amap.com/B01D601KPF/comment/600a99f2f50e9b1a5cc88d758092454c_2048_2048_80.jpg', duration: '约 1小时53分钟' } ], hotel: { name: '室韦临江蓝莓庄园', address: '临江屯' } },
                    { day: 5, title: '室韦 → 根河', totalDuration: '约 3小时11分钟', color: '#2196f3', points: [ { name: '中国室韦口岸', coord: [119.895746, 51.334108], img: 'https://aos-comment.amap.com/B01D601KPF/comment/600a99f2f50e9b1a5cc88d758092454c_2048_2048_80.jpg', duration: '起点' }, { name: '莫尔道嘎镇', coord: [120.785747, 51.255782], img: 'http://store.is.autonavi.com/showpic/66eb99165c30187301473bffb6ebe1ac', duration: '约 1小时24分钟' }, { name: '根河市', coord: [121.520165, 50.779758], img: 'https://aos-comment.amap.com/B01D600WUL/comment/74AC9427_810D_4FC8_860C_491EA4D277DE_L0_001_2000_1334_1743161951215_90922048.jpg', duration: '约 1小时47分钟' } ], hotel: { name: '根河宾馆', address: '中央街根阳桥西' } },
                    { day: 6, title: '根河 → 海拉尔', totalDuration: '约 3小时55分钟', color: '#3f51b5', points: [ { name: '根河市', coord: [121.520165, 50.779758], img: 'https://aos-comment.amap.com/B01D600WUL/comment/74AC9427_810D_4FC8_860C_491EA4D277DE_L0_001_2000_1334_1743161951215_90922048.jpg', duration: '起点' }, { name: '额尔古纳湿地景区', coord: [120.148865, 50.2492], img: 'http://store.is.autonavi.com/showpic/d570ed86f5043b3920a418fe7c4b057e', duration: '约 1小时52分钟' }, { name: '莫日格勒河', coord: [119.779039, 49.511658], img: 'http://store.is.autonavi.com/showpic/f1cb1d4a155087f2541aca0414cb3b74', duration: '约 1小时25分钟' }, { name: '海拉尔区', coord: [119.824542, 49.234715], img: 'https://aos-comment.amap.com/B01D600WR7/comment/content_media_external_images_media_1469_1736567111152_79798935.jpg', duration: '约 38 分钟' } ], hotel: { name: '海拉尔贝尔大酒店', address: '胜利大街31号' } },
                    { day: 7, title: '海拉尔 → 齐齐哈尔', totalDuration: '约 4小时47分钟', color: '#9c27b0', points: [ { name: '海拉尔区', coord: [119.824542, 49.234715], img: 'https://aos-comment.amap.com/B01D600WR7/comment/content_media_external_images_media_1469_1736567111152_79798935.jpg', duration: '起点' }, { name: '齐齐哈尔站', coord: [123.995988, 47.340409], img: 'https://aos-comment.amap.com/B01C400C81/comment/174643715413_1746437170552_05316738.jpg', duration: '约 4小时47分钟' } ], hotel: null }
                ]
            };

            const itineraryContainer = document.getElementById('itinerary-section');
            finalItinerary.dailyRoutes.forEach(route => {
                const dayHtml = `
                <div class="day-container">
                    <div class="day-header">Day ${route.day}: ${route.title}</div>
                    <div class="day-summary">
                        <div class="summary-item">
                            <span class="summary-item-icon">🕒</span>
                            <span>当日总计：<strong>${route.totalDuration}</strong></span>
                        </div>
                        ${route.hotel ? `
                        <div class="summary-item">
                            <span class="summary-item-icon">🏨</span>
                            <span>推荐住宿：<strong>${route.hotel.name}</strong></span>
                        </div>` : ''}
                    </div>
                    <div class="spot-cards">
                        ${route.points.map((p, index) => `
                        <div class="spot-card">
                            <img src="${p.img || 'https://placehold.co/600x400/dee2e6/6c757d?text=Image+Not+Found'}" alt="${p.name}" class="spot-img">
                            <div class="spot-info">
                                <h3 class="spot-name">${index + 1}. ${p.name}</h3>
                                <p class="spot-meta">车程：${p.duration}</p>
                            </div>
                        </div>`).join('')}
                    </div>
                </div>`;
                itineraryContainer.innerHTML += dayHtml;
            });

            const appUrl = finalItinerary.exclusiveMapUrl;
            const qrCodeImg = document.getElementById('qr-code-img');
            qrCodeImg.src = `https://api.qrserver.com/v1/create-qr-code/?size=140x140&data=${encodeURIComponent(appUrl)}`;

            var map = new AMap.Map('container', { zoom: 6, center: [122, 49], viewMode: '3D', pitch: 25 });
            const legendContainer = document.getElementById('map-legend');

            finalItinerary.dailyRoutes.forEach(route => {
                const path = route.points.map(p => p.coord);
                if (path.length > 1) {
                    new AMap.Polyline({ path: path, isOutline: true, outlineColor: '#000', borderWeight: 1, strokeColor: route.color, strokeWeight: 8, strokeStyle: 'solid', strokeOpacity: 0.8, zIndex: 50, map: map });
                }
                const legendItem = document.createElement('div');
                legendItem.className = 'legend-item';
                legendItem.innerHTML = `<div class="legend-color" style="background-color: ${route.color}"></div><span>Day ${route.day}</span>`;
                legendContainer.appendChild(legendItem);

                let pointCounter = 1;
                route.points.forEach(p => {
                    new AMap.Marker({
                        position: p.coord, title: p.name, map: map,
                        content: `<div class="custom-marker" style="background-color: ${route.color}">${pointCounter++}</div>`
                    });
                });
            });

            map.setFitView();

            document.getElementById('smart-map-btn').addEventListener('click', function(e) {
                e.preventDefault();
                window.location.href = appUrl;
            });
        }
    </script>
</body>
</html>